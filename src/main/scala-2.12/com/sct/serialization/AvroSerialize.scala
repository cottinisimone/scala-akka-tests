package com.sct.serialization

import java.io.ByteArrayOutputStream

import com.sksamuel.avro4s.{AvroOutputStream, SchemaFor, ToRecord}
import play.api.libs.json.Json

sealed trait EmptyTrait extends Serializable

object AvroSerialize extends App {

  case class EmptyClass() extends EmptyTrait

  println(Json.parse(toJson[EmptyClass](EmptyClass())))

  def toJson[T: SchemaFor: ToRecord](obj: T): Array[Byte] = {
    val output = new ByteArrayOutputStream
    val avro = AvroOutputStream.json[T](output)
    avro.write(obj)
    avro.close()
    output.toByteArray
  }


  val input = "0xaced00057372000a7363616c612e536f6d651122f2695ea18b740200014c0001787400124c6a6176612f6c616e672f4f626a6563743b7872000c7363616c612e4f7074696f6efe6937fddb0e6674020000787073720034636f6d2e6e6578742e6d7061792e75736572732e6170706c69636174696f6e2e6163746f722e757365722e557365725374617465bf0c6912dc4c17a50200114a0009637265617465644f6e4a0009757064617465644f6e4c000f61637469766174696f6e546f6b656e7400124c6a6176612f6c616e672f537472696e673b4c0009626c61636b6c6973747400204c7363616c612f636f6c6c656374696f6e2f696d6d757461626c652f5365743b4c000b6465736372697074696f6e74000e4c7363616c612f4f7074696f6e3b4c0007646576696365737400204c7363616c612f636f6c6c656374696f6e2f696d6d757461626c652f4d61703b4c0005656d61696c71007e00074c0010656d61696c496e7669746174696f6e737400214c7363616c612f636f6c6c656374696f6e2f696d6d757461626c652f4c6973743b4c0002696471007e00054c0007696d616765496471007e00074c000f696d6167655669736962696c6974797400244c636f6d2f6e6578742f6d7061792f75736572732f6d6f64656c732f507269766163793b4c00046e616d6571007e00074c000b70686f6e654e756d6265727400284c636f6d2f6e6578742f6d7061792f75736572732f6d6f64656c732f50686f6e654e756d6265723b4c000370696e71007e00074c001170726f66696c655669736962696c69747971007e000a4c000e736d73496e7669746174696f6e7371007e00094c00067374617475737400274c636f6d2f6e6578742f6d7061792f75736572732f6d6f64656c732f557365725374617475733b78700000015bbf7d55970000015bbf7d55977400053639393731737200287363616c612e636f6c6c656374696f6e2e696d6d757461626c652e53657424456d70747953657424f079374c5374b83602000078707372000b7363616c612e4e6f6e6524465024f653ca94ac0200007871007e0002737200237363616c612e636f6c6c656374696f6e2e696d6d757461626c652e4d6170244d617031fb65c59fb22b60d00200024c00046b65793171007e00014c000676616c75653171007e0001787074002445314243443342442d344335382d343144452d413436462d45393930433636374130394173720021636f6d2e6e6578742e6d7061792e75736572732e6d6f64656c732e446576696365a28e7075e69aac4b02000f4a0009637265617465644f6e4a0009757064617465644f6e4c000361726e71007e00074c000d636c69656e7456657273696f6e71007e00054c000666616d696c797400294c636f6d2f6e6578742f6d7061792f75736572732f6d6f64656c732f44657669636546616d696c793b4c0002696471007e00054c00066c6f63616c657400144c706c61792f6170692f6931386e2f4c616e673b4c00066d6f62696c6571007e000b4c00056d6f64656c71007e00054c001670686f6e6556616c69646174696f6e5265717565737471007e00074c000f706c6174666f726d56657273696f6e71007e00054c00097075626c69634b657971007e00054c00067374617475737400294c636f6d2f6e6578742f6d7061792f75736572732f6d6f64656c732f4465766963655374617475733b4c0005746f6b656e71007e00054c0007766f697041726e71007e000778700000015bbf7d55970000015bbf7d559771007e0012740008312e3020283734297372002c636f6d2e6e6578742e6d7061792e75736572732e6d6f64656c732e44657669636546616d696c7924494f53241beefbfdbd5afe38020001490005696e64657878700000000171007e001573720012706c61792e6170692e6931386e2e4c616e675ca0177fa0ca320f0200035a00086269746d617024304c0004636f646571007e00054c00066c6f63616c657400124c6a6176612f7574696c2f4c6f63616c653b7870017400026974737200106a6176612e7574696c2e4c6f63616c657ef811609c30f9ec03000649000868617368636f64654c0007636f756e74727971007e00054c000a657874656e73696f6e7371007e00054c00086c616e677561676571007e00054c000673637269707471007e00054c000776617269616e7471007e00057870ffffffff74000071007e0024740002697471007e002471007e00247873720026636f6d2e6e6578742e6d7061792e75736572732e6d6f64656c732e50686f6e654e756d6265723ec34dcc3381a8da02000a4200086269746d617024305a0007697356616c69644c00016371007e00054c000b636f756e747279436f646571007e00054c000d696e7465726e6174696f6e616c71007e00054c00016e71007e00054c00066e756d62657271007e00054c000f70686f6e654e756d6265725574696c74002e4c636f6d2f676f6f676c652f6931386e2f70686f6e656e756d626572732f50686f6e654e756d6265725574696c3b4c0011746f6931386e50686f6e654e756d6265727400364c636f6d2f676f6f676c652f6931386e2f70686f6e656e756d626572732f50686f6e656e756d6265722450686f6e654e756d6265723b4c000a76616c69646174696f6e7400114c7363616c612f46756e6374696f6e323b787000007400032b333971007e002b74000d2b33393334393331303433373674000a3334393331303433373674000a33343933313034333736707073720054636f6d2e6e6578742e6d7061792e75736572732e76616c696461746f72732e4d6f62696c6556616c69646174696f6e2424616e6f6e66756e2470686f6e654e756d6265725574696c56616c69646174696f6e243100000000000000000200034c0006246f757465727400314c636f6d2f6e6578742f6d7061792f75736572732f76616c696461746f72732f4d6f62696c6556616c69646174696f6e3b4c0012636f756e747279436f64654669656c64243171007e00054c001270686f6e654e756d6265724669656c64243171007e0005787071007e002a74000b636f756e747279436f646574000b70686f6e654e756d6265727400096950686f6e6520367371007e001274000631302e332e317401884d494942496a414e42676b71686b6947397730424151454641414f43415138414d49494243674b4341514541332b6d6c57614c436c4b4e5164495a776e4754456b784e6e7a6966326c6d32647275746943596f6d506e6836453673665338737a374b50484a5149705871642f392b35756f69336561354b7a77595a536337304f746b6b69752b4d4532434648746c7646667670355a50383276634257314d3264315347467a35563943496342685677657353774335537a4b466c4e6c47665049363245784a51374b6e624b2f525076756d7549432b7151716561672f5841616f45396563717850577142523372534d6231622f75796b79524c645771455475615459674a6d6e7043776c33672f4e554a6b51496a717a4f4c546d5862526756495330466245772f6b64793763594432594262526c75374e6f774a617056364b676d39764a3832756f746177417064417731484f644c3962676c33304a7a71487a6c4b47682f424c5246466c514d736575335738387357706a2f55346b3777576c4b5149444151414273720031636f6d2e6e6578742e6d7061792e75736572732e6d6f64656c732e44657669636553746174757324566572696669656424b4108eb61e2dd412020000787071007e000e71007e001271007e0012737200327363616c612e636f6c6c656374696f6e2e696d6d757461626c652e4c6973742453657269616c697a6174696f6e50726f7879000000000000000103000078707372002c7363616c612e636f6c6c656374696f6e2e696d6d757461626c652e4c69737453657269616c697a65456e64248a5c635bf7530b6d02000078707874002432333566313434392d326462612d313165372d393233612d30323432616331313030303271007e00127372002d636f6d2e6e6578742e6d7061792e75736572732e6d6f64656c732e50726976616379244576657279626f647924c36fb53b27653679020000787071007e001271007e002a71007e001271007e003f71007e003a7372002f636f6d2e6e6578742e6d7061792e75736572732e6d6f64656c732e5573657253746174757324566572696669656424b0cf0613bd0aa0a60200007870"



}
